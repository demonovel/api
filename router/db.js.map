{"version":3,"file":"db.js","sourceRoot":"","sources":["db.ts"],"names":[],"mappings":";;;;;AAAA,qCAA0C;AAG1C,2DAAmC;AAEnC,kBAAe,GAAG,EAAE;IAEnB,MAAM,MAAM,GAAG,gBAAM,EAAE,CAAC;IAExB,MAAM,CAAC,GAAG,CAAC,uBAAuB,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;QAE5D,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;QAEpC,IAAI,CAAe,CAAC;QAEpB,mBAAmB;QACnB,gDAAgD;QAEhD,IAAI,GAAG,CAAC,MAAM,KAAK,MAAM,IAAI,GAAG,CAAC,MAAM,KAAK,KAAK,EACjD;YACC,CAAC,GAAG,gBAAM,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,CAAA;SACxC;aAED;YACC,CAAC,GAAG,gBAAM,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,CAAC,CAAA;SAC9B;QAED,OAAO,CAAC;aACN,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC;YACtB,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;YACrB,KAAK,EAAE,KAAK;YACZ,IAAI;SACJ,CAAC,CAAC;aACF,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YAChC,KAAK,EAAE,IAAI;YACX,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YAClB,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;SACrB,CAAC,CAAC,CACH;IACF,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAA;AACd,CAAC,CAAA","sourcesContent":["import express, { Router } from 'express';\nimport { readJSON } from 'fs-extra';\nimport { resolve } from 'path';\nimport fileDB from '../lib/fileDB';\n\nexport default () =>\n{\n\tconst router = Router();\n\n\trouter.all('/file/:siteID/:hashID', async (req, res, next) =>\n\t{\n\t\tlet { siteID, hashID } = req.params;\n\n\t\tlet p: Promise<any>;\n\n\t\t//console.log(req);\n\t\t//console.log(req.method, req.params, req.body);\n\n\t\tif (req.method === 'POST' || req.method === 'PUT')\n\t\t{\n\t\t\tp = fileDB.set(siteID, hashID, req.body)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tp = fileDB.get(siteID, hashID)\n\t\t}\n\n\t\treturn p\n\t\t\t.then(data => res.json({\n\t\t\t\ttimestamp: Date.now(),\n\t\t\t\terror: false,\n\t\t\t\tdata,\n\t\t\t}))\n\t\t\t.catch(e => res.status(400).json({\n\t\t\t\terror: true,\n\t\t\t\tmessage: String(e),\n\t\t\t\ttimestamp: Date.now(),\n\t\t\t}))\n\t\t;\n\t});\n\n\treturn router\n}\n"]}